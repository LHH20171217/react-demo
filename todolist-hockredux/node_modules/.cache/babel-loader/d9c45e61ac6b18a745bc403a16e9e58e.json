{"ast":null,"code":"import { DEL_TODO_ITEM, CHANGE_TODO_ITEM, ADD_TODO_ITEM, REMOVE_FINISHED_TODO_ITEM, IS_CHECKED_ALL_TODO_ITEM } from './actionTypes'; // 默认的数据\n\nconst defaultState = {\n  todos: [{\n    id: 1,\n    title: '看一小时React的课程',\n    finished: false\n  }, {\n    id: 2,\n    title: '打一小时篮球',\n    finished: false\n  }, {\n    id: 3,\n    title: '游泳一小时',\n    finished: false\n  }, {\n    id: 4,\n    title: '看书一小时',\n    finished: false\n  }],\n  finishedCount: 0\n};\nexport default ((state = defaultState, action) => {\n  console.log(state, action); // 1. 删除一条Todo\n\n  if (action.type === DEL_TODO_ITEM) {\n    const newState = JSON.parse(JSON.stringify(state));\n    console.log('newState', newState); // 1.1 遍历\n\n    let finishedCount = 0;\n    newState.todos.forEach((todo, index) => {\n      if (todo.id === action.todoId) {\n        newState.todos.splice(index, 1);\n      }\n    }); // 1.2 处理选中的\n\n    newState.todos.forEach((todo, index) => {\n      if (todo.finished) {\n        finishedCount += 1;\n      }\n    }); // 1.3 更新状态\n\n    newState.finishedCount = finishedCount;\n    return newState;\n  } // 2. 修改一条记录的状态\n\n\n  if (action.type === CHANGE_TODO_ITEM) {\n    // 1.1 遍历\n    const newState = JSON.parse(JSON.stringify(state));\n    let finishedCount = 0;\n    newState.todos.forEach((todo, index) => {\n      if (todo.id === action.todoId) {\n        todo.finished = action.isFinished;\n      }\n\n      if (todo.finished) {\n        finishedCount += 1;\n      }\n    }); // 2.3 返回新的数据状态\n\n    newState.finishedCount = finishedCount;\n    return newState;\n  } // 3. 添加一条记录\n\n\n  if (action.type === ADD_TODO_ITEM) {\n    const newState = JSON.parse(JSON.stringify(state));\n    newState.todos.push(action.todo);\n    return newState;\n  } // 4. 删除已经完成的所有任务\n\n\n  if (action.type === REMOVE_FINISHED_TODO_ITEM) {\n    const newState = JSON.parse(JSON.stringify(state)); // 4.1 取出对象\n\n    let tempArr = [];\n    newState.todos.forEach((todo, index) => {\n      if (!todo.finished) {\n        tempArr.push(todo);\n      }\n    }); // 4.2 返回最新的状态\n\n    newState.todos = tempArr;\n    newState.finishedCount = 0;\n    return newState;\n  } // 5. 全选和非全选\n\n\n  if (action.type === IS_CHECKED_ALL_TODO_ITEM) {\n    const newState = JSON.parse(JSON.stringify(state)); // 5.1 遍历\n\n    let finishedCount = 0;\n    newState.todos.forEach((todo, index) => {\n      todo.finished = action.flag;\n    }); // 5.2 处理选中的\n\n    newState.todos.forEach((todo, index) => {\n      if (todo.finished) {\n        finishedCount += 1;\n      }\n    }); // 5.3 更新状态\n\n    newState.finishedCount = finishedCount;\n    return newState;\n  }\n\n  return state;\n});","map":{"version":3,"sources":["/Users/cvter/Documents/react-demo/todolist-hockredux/src/store/reducer.js"],"names":["DEL_TODO_ITEM","CHANGE_TODO_ITEM","ADD_TODO_ITEM","REMOVE_FINISHED_TODO_ITEM","IS_CHECKED_ALL_TODO_ITEM","defaultState","todos","id","title","finished","finishedCount","state","action","console","log","type","newState","JSON","parse","stringify","forEach","todo","index","todoId","splice","isFinished","push","tempArr","flag"],"mappings":"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","sourcesContent":["import {\n    DEL_TODO_ITEM,\n    CHANGE_TODO_ITEM,\n    ADD_TODO_ITEM,\n    REMOVE_FINISHED_TODO_ITEM,\n    IS_CHECKED_ALL_TODO_ITEM\n} from './actionTypes'\n\n// 默认的数据\nconst defaultState = {\n    todos: [{\n            id: 1,\n            title: '看一小时React的课程',\n            finished: false\n        },\n        {\n            id: 2,\n            title: '打一小时篮球',\n            finished: false\n        },\n        {\n            id: 3,\n            title: '游泳一小时',\n            finished: false\n        },\n        {\n            id: 4,\n            title: '看书一小时',\n            finished: false\n        },\n    ],\n    finishedCount: 0\n};\n\nexport default (state = defaultState, action) => {\n    console.log(state, action);\n    // 1. 删除一条Todo\n    if (action.type === DEL_TODO_ITEM) {\n        const newState = JSON.parse(JSON.stringify(state));\n        console.log('newState',newState)\n        // 1.1 遍历\n        let finishedCount = 0;\n        newState.todos.forEach((todo, index) => {\n            if (todo.id === action.todoId) {\n                newState.todos.splice(index, 1);\n            }\n        });\n        // 1.2 处理选中的\n        newState.todos.forEach((todo, index) => {\n            if (todo.finished) {\n                finishedCount += 1;\n            }\n        });\n        // 1.3 更新状态\n        newState.finishedCount = finishedCount;\n        return newState;\n    }\n    // 2. 修改一条记录的状态\n    if (action.type === CHANGE_TODO_ITEM) {\n        // 1.1 遍历\n        const newState = JSON.parse(JSON.stringify(state));\n        let finishedCount = 0;\n        newState.todos.forEach((todo, index) => {\n            if (todo.id === action.todoId) {\n                todo.finished = action.isFinished;\n            }\n            if (todo.finished) {\n                finishedCount += 1;\n            }\n        });\n\n        // 2.3 返回新的数据状态\n        newState.finishedCount = finishedCount;\n        return newState;\n    }\n    // 3. 添加一条记录\n    if (action.type === ADD_TODO_ITEM) {\n        const newState = JSON.parse(JSON.stringify(state));\n        newState.todos.push(action.todo);\n        return newState;\n    }\n    // 4. 删除已经完成的所有任务\n    if (action.type === REMOVE_FINISHED_TODO_ITEM) {\n        const newState = JSON.parse(JSON.stringify(state));\n        // 4.1 取出对象\n        let tempArr = [];\n        newState.todos.forEach((todo, index) => {\n            if (!todo.finished) {\n                tempArr.push(todo);\n            }\n        });\n        // 4.2 返回最新的状态\n        newState.todos = tempArr;\n        newState.finishedCount = 0;\n        return newState;\n    }\n    // 5. 全选和非全选\n    if (action.type === IS_CHECKED_ALL_TODO_ITEM) {\n        const newState = JSON.parse(JSON.stringify(state));\n        // 5.1 遍历\n        let finishedCount = 0;\n        newState.todos.forEach((todo, index) => {\n            todo.finished = action.flag;\n        });\n\n        // 5.2 处理选中的\n        newState.todos.forEach((todo, index) => {\n            if (todo.finished) {\n                finishedCount += 1;\n            }\n        });\n\n        // 5.3 更新状态\n        newState.finishedCount = finishedCount;\n        return newState;\n    }\n    return state;\n}"]},"metadata":{},"sourceType":"module"}