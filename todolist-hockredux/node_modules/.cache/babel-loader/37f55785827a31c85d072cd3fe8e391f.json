{"ast":null,"code":"import { DEL_TODO_ITEM, CHANGE_TODO_ITEM, ADD_TODO_ITEM, REMOVE_FINISHED_TODO_ITEM, IS_CHECKED_ALL_TODO_ITEM } from './actionTypes'; // 默认的数据\n// const defaultState = {\n//     todos: [{\n//             id: 1,\n//             title: '看一小时React的课程',\n//             finished: false\n//         },\n//         {\n//             id: 2,\n//             title: '打一小时篮球',\n//             finished: false\n//         },\n//         {\n//             id: 3,\n//             title: '游泳一小时',\n//             finished: false\n//         },\n//         {\n//             id: 4,\n//             title: '看书一小时',\n//             finished: false\n//         },\n//     ],\n//     finishedCount: 0\n// };\n\nexport default ((state, action) => {\n  console.log(state, action); // 1. 删除一条Todo\n\n  if (action.type === DEL_TODO_ITEM) {\n    const newState = JSON.parse(JSON.stringify(state));\n    console.log('newState', newState); // 1.1 遍历\n\n    let finishedCount = 0;\n    newState.todos.forEach((todo, index) => {\n      if (todo.id === action.todoId) {\n        newState.todos.splice(index, 1);\n      }\n    }); // 1.2 处理选中的\n\n    newState.todos.forEach((todo, index) => {\n      if (todo.finished) {\n        finishedCount += 1;\n      }\n    }); // 1.3 更新状态\n\n    newState.finishedCount = finishedCount;\n    return newState;\n  } // 2. 修改一条记录的状态\n\n\n  if (action.type === CHANGE_TODO_ITEM) {\n    // 1.1 遍历\n    const newState = JSON.parse(JSON.stringify(state));\n    let finishedCount = 0;\n    newState.todos.forEach((todo, index) => {\n      if (todo.id === action.todoId) {\n        todo.finished = action.isFinished;\n      }\n\n      if (todo.finished) {\n        finishedCount += 1;\n      }\n    }); // 2.3 返回新的数据状态\n\n    newState.finishedCount = finishedCount;\n    return newState;\n  } // 3. 添加一条记录\n\n\n  if (action.type === ADD_TODO_ITEM) {\n    const newState = JSON.parse(JSON.stringify(state));\n    newState.todos.push(action.todo);\n    return newState;\n  } // 4. 删除已经完成的所有任务\n\n\n  if (action.type === REMOVE_FINISHED_TODO_ITEM) {\n    const newState = JSON.parse(JSON.stringify(state)); // 4.1 取出对象\n\n    let tempArr = [];\n    newState.todos.forEach((todo, index) => {\n      if (!todo.finished) {\n        tempArr.push(todo);\n      }\n    }); // 4.2 返回最新的状态\n\n    newState.todos = tempArr;\n    newState.finishedCount = 0;\n    return newState;\n  } // 5. 全选和非全选\n\n\n  if (action.type === IS_CHECKED_ALL_TODO_ITEM) {\n    const newState = JSON.parse(JSON.stringify(state)); // 5.1 遍历\n\n    let finishedCount = 0;\n    newState.todos.forEach((todo, index) => {\n      todo.finished = action.flag;\n    }); // 5.2 处理选中的\n\n    newState.todos.forEach((todo, index) => {\n      if (todo.finished) {\n        finishedCount += 1;\n      }\n    }); // 5.3 更新状态\n\n    newState.finishedCount = finishedCount;\n    return newState;\n  }\n\n  return state;\n});","map":{"version":3,"sources":["/Users/cvter/Documents/react-demo/todolist-hockredux/src/store/reducer.js"],"names":["DEL_TODO_ITEM","CHANGE_TODO_ITEM","ADD_TODO_ITEM","REMOVE_FINISHED_TODO_ITEM","IS_CHECKED_ALL_TODO_ITEM","state","action","console","log","type","newState","JSON","parse","stringify","finishedCount","todos","forEach","todo","index","id","todoId","splice","finished","isFinished","push","tempArr","flag"],"mappings":"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","sourcesContent":["import {\n    DEL_TODO_ITEM,\n    CHANGE_TODO_ITEM,\n    ADD_TODO_ITEM,\n    REMOVE_FINISHED_TODO_ITEM,\n    IS_CHECKED_ALL_TODO_ITEM\n} from './actionTypes'\n\n// 默认的数据\n// const defaultState = {\n//     todos: [{\n//             id: 1,\n//             title: '看一小时React的课程',\n//             finished: false\n//         },\n//         {\n//             id: 2,\n//             title: '打一小时篮球',\n//             finished: false\n//         },\n//         {\n//             id: 3,\n//             title: '游泳一小时',\n//             finished: false\n//         },\n//         {\n//             id: 4,\n//             title: '看书一小时',\n//             finished: false\n//         },\n//     ],\n//     finishedCount: 0\n// };\n\nexport default (state, action) => {\n    console.log(state, action);\n    // 1. 删除一条Todo\n    if (action.type === DEL_TODO_ITEM) {\n        const newState = JSON.parse(JSON.stringify(state));\n        console.log('newState',newState)\n        // 1.1 遍历\n        let finishedCount = 0;\n        newState.todos.forEach((todo, index) => {\n            if (todo.id === action.todoId) {\n                newState.todos.splice(index, 1);\n            }\n        });\n        // 1.2 处理选中的\n        newState.todos.forEach((todo, index) => {\n            if (todo.finished) {\n                finishedCount += 1;\n            }\n        });\n        // 1.3 更新状态\n        newState.finishedCount = finishedCount;\n        return newState;\n    }\n    // 2. 修改一条记录的状态\n    if (action.type === CHANGE_TODO_ITEM) {\n        // 1.1 遍历\n        const newState = JSON.parse(JSON.stringify(state));\n        let finishedCount = 0;\n        newState.todos.forEach((todo, index) => {\n            if (todo.id === action.todoId) {\n                todo.finished = action.isFinished;\n            }\n            if (todo.finished) {\n                finishedCount += 1;\n            }\n        });\n\n        // 2.3 返回新的数据状态\n        newState.finishedCount = finishedCount;\n        return newState;\n    }\n    // 3. 添加一条记录\n    if (action.type === ADD_TODO_ITEM) {\n        const newState = JSON.parse(JSON.stringify(state));\n        newState.todos.push(action.todo);\n        return newState;\n    }\n    // 4. 删除已经完成的所有任务\n    if (action.type === REMOVE_FINISHED_TODO_ITEM) {\n        const newState = JSON.parse(JSON.stringify(state));\n        // 4.1 取出对象\n        let tempArr = [];\n        newState.todos.forEach((todo, index) => {\n            if (!todo.finished) {\n                tempArr.push(todo);\n            }\n        });\n        // 4.2 返回最新的状态\n        newState.todos = tempArr;\n        newState.finishedCount = 0;\n        return newState;\n    }\n    // 5. 全选和非全选\n    if (action.type === IS_CHECKED_ALL_TODO_ITEM) {\n        const newState = JSON.parse(JSON.stringify(state));\n        // 5.1 遍历\n        let finishedCount = 0;\n        newState.todos.forEach((todo, index) => {\n            todo.finished = action.flag;\n        });\n\n        // 5.2 处理选中的\n        newState.todos.forEach((todo, index) => {\n            if (todo.finished) {\n                finishedCount += 1;\n            }\n        });\n\n        // 5.3 更新状态\n        newState.finishedCount = finishedCount;\n        return newState;\n    }\n    return state;\n}"]},"metadata":{},"sourceType":"module"}